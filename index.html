<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SD Search</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="hw2_search_dataset.js"></script>
    <script defer src="script.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #fff;
            color: #000;
            transition: background-color 0.3s, color 0.3s;
        }
        .dark-mode {
            background-color: #121212;
            color: #fff;
        }
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: #f8f9fa;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s;
        }
        .dark-mode .navbar {
            background: #333;
        }
        .logo {
            font-size: 20px;
            font-weight: bold;
        }
        #search-box {
            flex: 1;
            margin: 0 20px;
            padding: 8px;
            font-size: 16px;
        }
        .icons {
            display: flex;
            align-items: center;
        }
        .user-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: gray;
            margin-left: 10px;
        }
        main {
            margin-top: 60px;
            padding: 20px;
        }
        #results div {
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }
        #load-more {
            display: block;
            margin: 20px auto;
            padding: 10px;
            font-size: 16px;
            cursor: pointer;
        }
        #scroll-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            display: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <header class="navbar">
        <div class="logo">SD Search</div>
        <input type="text" id="search-box" placeholder="ÂúãÁ´ã‰∏≠Â§ÆÂ§ßÂ≠∏">
        <div class="icons">
            <button id="theme-toggle">üåû</button>
            <div class="user-icon"></div>
        </div>
    </header>
    
    <main>
        <div class="info-bar">
            <span id="result-count">ÂÖ±ÊâæÂà∞ 0 Á≠ÜÁµêÊûú</span>
            <select id="sort-options">
                <option value="title">ÊåâÁÖßÊ®ôÈ°å</option>
                <option value="created_at">ÊåâÁÖßÊôÇÈñì</option>
                <option value="popularity">ÊåâÁÖß‰∫∫Ê∞£</option>
            </select>
        </div>
        
        <div id="results"></div>
        
        <button id="load-more">ËºâÂÖ•Êõ¥Â§ö</button>
    </main>
    
    <button id="scroll-to-top">‚Üë</button>

    <script>
        let currentPage = 0;
        const itemsPerPage = 10;
        let dataset = SEARCH_DATASET;

        function renderResults() {
            $("#results").empty();
            let start = currentPage * itemsPerPage;
            let end = start + itemsPerPage;
            let resultsToShow = dataset.slice(0, end);
            
            resultsToShow.forEach(item => {
                $("#results").append(`
                    <div>
                        <a href="${item.url}" target="_blank"><h3>${item.title}</h3></a>
                        <p>${item.text}</p>
                        <small>${item.created_at} | ‰∫∫Ê∞£: ${item.popularity}</small>
                    </div>
                `);
            });
            $("#result-count").text(`ÂÖ±ÊâæÂà∞ ${dataset.length} Á≠ÜÁµêÊûú`);
        }

        $("#load-more").click(function() {
            currentPage++;
            renderResults();
        });

        $("#sort-options").change(function() {
            let sortBy = $(this).val();
            dataset.sort((a, b) => {
                if (sortBy === "title") return a.title.localeCompare(b.title);
                if (sortBy === "created_at") return new Date(b.created_at) - new Date(a.created_at);
                if (sortBy === "popularity") return b.popularity - a.popularity;
            });
            currentPage = 0;
            renderResults();
        });

        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $("#scroll-to-top").fadeIn();
            } else {
                $("#scroll-to-top").fadeOut();
            }
        });
        
        $("#scroll-to-top").click(function() {
            $("html, body").animate({ scrollTop: 0 }, "slow");
        });
        
        $("#theme-toggle").click(function() {
            $("body").toggleClass("dark-mode");
            $(this).text($("body").hasClass("dark-mode") ? "üåô" : "üåû");
        });
        
        $(document).ready(function() {
            renderResults();
        });
    </script>
</body>
</html>
